name: phalconphp
version: 0.1.8
inherits: wercker/php@1.0.1
type: box
platform: ubuntu@12.04
description: wercker box for php with phalconphp installed
keywords:
  - phalconphp
  - php
  - opensource
  - database
packages:
  - phalconphp@1.2.5
script: |
  # Install php
  sudo add-apt-repository ppa:ondrej/php5 -y
  sudo apt-get update -y
  sudo apt-get install php5 php5-common php5-dev php-pear php5-curl php5-gd php5-cli php5-apcu php5-mcrypt php5-intl php5-xdebug libicu-dev -y
  #imagick
  echo '\n' | pecl install imagick
  
  #phalconphp
  git clone -q --depth=1 https://github.com/phalcon/cphalcon.git -b 1.2.5
  cd cphalcon/ext;
  export CFLAGS="-g3 -O1 -fno-delete-null-pointer-checks -Wall";
  phpize && ./configure --enable-phalcon && make -j4 && sudo make install
  echo 'extension=phalcon.so' >> $HOME/.phpenv/versions/$(phpenv version-name)/etc/php.ini
  echo 'extension=intl.so' >> $HOME/.phpenv/versions/$(phpenv version-name)/etc/php.ini
  phpenv rehash
